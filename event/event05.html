<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì²¨ë¶€íŒŒì¼ ì¸ë„¤ì¼</title>
  <style>
    div.image {
      background-image: url('./plus.png');
      background-size: 100% 100%;
      background-repeat: no-repeat;
      background-position: center;
      width: 70px;
      height: 70px;
      cursor: pointer;
    }

    label {
      display: flex;
    }
    div.wrap {
      margin: 0 auto;
      display: flex;
    }
    button {
      display: none;
      width: 20px;
      height: 20px;
      justify-content: center;
      align-items: center;
      padding: 0;
      margin: 0;
      color:aliceblue;
      background-color: rgb(0, 0, 0);
      border-width: 2px;
      border-color: rgb(0, 0, 0);
      border-radius: 7px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <label for="attach">
    <div class="wrap">
      <div class="image"></div>
      <button type="button">X</button>
    </div>
  </label>
  <input type="file" id="attach" style="display: none;">

</body>
<script>
  // ì—…ë¡œë“œëœ íŒŒì¼ì€ input ê°ì²´ì˜ í”„ë¡œí¼í‹°ì— ì¡´ì¬í•œë‹¤.
  const input = document.getElementById("attach");
  // ì‚¬ìš©ìê°€ ì—…ë¡œë“œí•œ íŒŒì¼ì— ë”°ë¼ ë°°ê²½ ì´ë¯¸ì§€ê°€ ë³€ê²½ë˜ì–´ì•¼ í•˜ëŠ” ê°ì²´
  const thumbnail = document.querySelector("div.image");
  // change ì´ë²¤íŠ¸: í•´ë‹¹ ê°ì²´ì— ë³€í™”ê°€ ìˆì„ ë•Œ(íŒŒì¼ì´ ì—…ë¡œë“œ ë˜ì—ˆì„ ë•Œ)
  const delbutton = document.querySelector("button");
  input.addEventListener("change", (e) => {
    console.log("ì—…ë¡œë“œ! ğŸ˜");
    // ì—…ë¡œë“œí•œ íŒŒì¼ì„ ì½ì–´ì˜¬ ê°ì²´
    const reader = new FileReader();

    // í•´ë‹¹ íŒŒì¼ì˜ ì •ë³´ë¥¼ readAsDataURLì— ì „ë‹¬í•˜ë©´, ì—…ë¡œë“œëœ íŒŒì¼ì˜ ì ˆëŒ€ê²½ë¡œê°€ ì¸ì½”ë”©ëœë‹¤.
    reader.readAsDataURL(e.target.files[0]);

    // byte ë‹¨ìœ„ë¡œ ì½ì–´ì˜¨ ë’¤ ì „ë¶€ ì½ì—ˆë‹¤ë©´ load ì´ë²¤íŠ¸ ë°œìƒ
    reader.onload = (e) => {
      // ì´ë²¤íŠ¸ ê°ì²´ì¸ eì— íŒŒì¼ì˜ ì •ë³´ë“¤ì´ ìˆìœ¼ë©°,
      // resultì—ëŠ” ì ˆëŒ€ê²½ë¡œê°€ base64ë¡œ ì¸ì½”ë”©ëœ ë¬¸ìì—´ê°’ì´ ìˆë‹¤.
      const path = e.target.result;
      // í•­ìƒ resultì˜ ì‹œì‘ì€ íŒŒì¼ì˜ ì¢…ë¥˜(íƒ€ì…)ì´ê¸° ë•Œë¬¸ì—,
      // image ë¬¸ìì—´ì´ í¬í•¨ë˜ì–´ ìˆë‹¤ë©´, ì´ë¯¸ì§€ íŒŒì¼ì´ë‹¤.
      if(path.includes('image')){
        // ì¸ì½”ë”©ëœ íŒŒì¼ì˜ ì ˆëŒ€ ê²½ë¡œë¥¼ ê·¸ëŒ€ë¡œ urlì— ì „ë‹¬í•œë‹¤.
        thumbnail.style.backgroundImage = `url('${path}')`;
      }else{
        // ë§Œì•½ ì´ë¯¸ì§€ íŒŒì¼ì´ ì•„ë‹ˆë¼ë©´ ì¤€ë¹„í•´ë†“ì€ ì´ë¯¸ì§€ ê²½ë¡œë¥¼ ì „ë‹¬í•œë‹¤.
        thumbnail.style.backgroundImage = `url('./file.png')`;
      }
      delbutton.style.display = 'flex'
    }
  });

  // ì—…ë¡œë“œ í›„ Xë²„íŠ¼ì„ ìƒì„±í•˜ê³ ,
  delbutton.addEventListener("click",function(e){
    input.value =""
    delbutton.style.display = 'none'
    if(!input.value){
      thumbnail.style.backgroundImage = `url('./plus.png')`
    }
  })
  // Xë²„íŠ¼ í´ë¦­ ì‹œ input ê°ì²´ì˜ valueë¥¼ ë¹ˆ ë¬¸ìì—´ë¡œ ì´ˆê¸°í™”í•˜ê³ ,
  // ì´ë¯¸ì§€ëŠ” ê¸°ì¡´ ì´ë¯¸ì§€ë¡œ ë³€ê²½ì‹œí‚¨ë‹¤.

</script>
</html>